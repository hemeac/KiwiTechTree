// Kiwi's Tech Tree Overhaul - Antenna Upgrades
// Version 2.0
// Created 30 April 2022 for KSP 1.12.3
// Last Updated: 30 April 2022 for KSP 1.12.3

@PART[*]:HAS[@MODULE[ModuleDataTransmitter],~antennaUpgrade[off]]:FOR[zzKiwiTechTree]
{
	@MODULE[ModuleDataTransmitter]:HAS[~antennaType[INTERNAL]]
	{
		//#$../../costAdjust$
		antennaPower1 = #$antennaPower$
		antennaPower2 = #$antennaPower$
		antennaPower3 = #$antennaPower$
		antennaPower4 = #$antennaPower$
		@antennaPower1 *= #$@KIWI_ANTENNA_SETTINGS/STRENGTH_UPGRADE1_MULTIPLIER$
		@antennaPower2 *= #$@KIWI_ANTENNA_SETTINGS/STRENGTH_UPGRADE2_MULTIPLIER$
		@antennaPower3 *= #$@KIWI_ANTENNA_SETTINGS/STRENGTH_UPGRADE3_MULTIPLIER$
		@antennaPower4 *= #$@KIWI_ANTENNA_SETTINGS/STRENGTH_UPGRADE4_MULTIPLIER$
		
		packetResourceCost1 = #$packetResourceCost$
		packetResourceCost2 = #$packetResourceCost$
		packetResourceCost3 = #$packetResourceCost$
		packetResourceCost4 = #$packetResourceCost$
		@packetResourceCost1 *= #$@KIWI_ANTENNA_SETTINGS/ECCOST_UPGRADE1_MULTIPLIER$
		@packetResourceCost2 *= #$@KIWI_ANTENNA_SETTINGS/ECCOST_UPGRADE2_MULTIPLIER$
		@packetResourceCost3 *= #$@KIWI_ANTENNA_SETTINGS/ECCOST_UPGRADE3_MULTIPLIER$
		@packetResourceCost4 *= #$@KIWI_ANTENNA_SETTINGS/ECCOST_UPGRADE4_MULTIPLIER$
		
		showUpgradesInModuleInfo = true
		UPGRADES
		{
			UPGRADE
			{
				name__ = antennaUpgrade1
				techRequired__ = antennaArrays					
				antennaPower = #$../../antennaPower1$
				packetResourceCost = #$../../packetResourceCost1$
			}
			UPGRADE
			{
				name__ = antennaUpgrade2
				techRequired__ = lowGainCommunications
				antennaPower = #$../../antennaPower2$
				packetResourceCost = #$../../packetResourceCost2$
			}
			UPGRADE
			{
				name__ = antennaUpgrade3
				techRequired__ = signalProcessing					
				antennaPower = #$../../antennaPower3$
				packetResourceCost = #$../../packetResourceCost3$
			}
			UPGRADE
			{
				name__ = antennaUpgrade4
				techRequired__ = xBandCommunications
				antennaPower = #$../../antennaPower4$
				packetResourceCost = #$../../packetResourceCost4$
			}
		}
		
	}
}

PARTUPGRADE:NEEDS[Squad]
{
	type = antenna
	name = antennaUpgrade1
	partIcon = longAntenna
	techRequired = antennaArrays
	entryCost = 50000
	title = #LOC_KTT_PARTUPGRADE_TITLE_ANTENNA_LEVEL1 // Antenna Power Boost and Weight Reduction (Level 1)
	manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
	description = #LOC_KTT_PARTUPGRADE_DESCRIPITION_ANTENNA // Our imagineers have worked tirelessly to get us a UPGRADESIGNAL% boost to the signal and UPGRADEEC% reduction in the EC requirement.
}
@PARTUPGRADE[antennaUpgrade1]:HAS[~antennaUpgrade[off]]:AFTER[KiwiTechTree]
{
	antennaText = #$@KIWI_ANTENNA_SETTINGS/STRENGTH_UPGRADE1_MULTIPLIER$
	@antennaText -= 1
	@antennaText *= 100
	
	ecText = #$@KIWI_ANTENNA_SETTINGS/ECCOST_UPGRADE1_MULTIPLIER$
	@ecText -= 1
	@ecText *= 100
	
	@description ^= #:UPGRADESIGNAL:$antennaText$:
	@description ^= #:UPGRADEEC:$ecText$:
}
PARTUPGRADE:NEEDS[Squad]
{
	type = antenna
	name = antennaUpgrade2
	partIcon = longAntenna
	techRequired = lowGainCommunications
	entryCost = 200000
	title = #LOC_KTT_PARTUPGRADE_TITLE_ANTENNA_LEVEL2 // Antenna Power Boost and Weight Reduction (Level 2)
	manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
	description = #LOC_KTT_PARTUPGRADE_DESCRIPITION_ANTENNA // Our imagineers have worked tirelessly to get us a UPGRADESIGNAL% boost to the signal and UPGRADEEC% reduction in the EC requirement.
}
@PARTUPGRADE[antennaUpgrade2]:HAS[~antennaUpgrade[off]]:AFTER[KiwiTechTree]
{
	antennaText = #$@KIWI_ANTENNA_SETTINGS/STRENGTH_UPGRADE2_MULTIPLIER$
	@antennaText -= 1
	@antennaText *= 100
	
	ecText = #$@KIWI_ANTENNA_SETTINGS/ECCOST_UPGRADE2_MULTIPLIER$
	@ecText -= 1
	@ecText *= 100
	
	@description ^= #:UPGRADESIGNAL:$antennaText$:
	@description ^= #:UPGRADEEC:$ecText$:
}
PARTUPGRADE:NEEDS[Squad]
{
	type = antenna
	name = antennaUpgrade3
	partIcon = longAntenna
	techRequired = signalProcessing
	entryCost = 1000000
	title = #LOC_KTT_PARTUPGRADE_TITLE_ANTENNA_LEVEL3 // Antenna Power Boost and Weight Reduction (Level 3)
	manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
	description = #LOC_KTT_PARTUPGRADE_DESCRIPITION_ANTENNA // Our imagineers have worked tirelessly to get us a UPGRADESIGNAL% boost to the signal and UPGRADEEC% reduction in the EC requirement.
}
@PARTUPGRADE[antennaUpgrade3]:HAS[~antennaUpgrade[off]]:AFTER[KiwiTechTree]
{
	antennaText = #$@KIWI_ANTENNA_SETTINGS/STRENGTH_UPGRADE3_MULTIPLIER$
	@antennaText -= 1
	@antennaText *= 100
	
	ecText = #$@KIWI_ANTENNA_SETTINGS/ECCOST_UPGRADE3_MULTIPLIER$
	@ecText -= 1
	@ecText *= 100
	
	@description ^= #:UPGRADESIGNAL:$antennaText$:
	@description ^= #:UPGRADEEC:$ecText$:
}
PARTUPGRADE:NEEDS[Squad]
{
	type = antenna
	name = antennaUpgrade4
	partIcon = longAntenna
	techRequired = xBandCommunications
	entryCost = 3000000
	title = #LOC_KTT_PARTUPGRADE_TITLE_ANTENNA_LEVEL4 // Antenna Power Boost and Weight Reduction (Level 4)
	manufacturer = #LOC_KTT_PARTUPGRADE_MANUFACTURER // Kiwi Imagineers
	description = #LOC_KTT_PARTUPGRADE_DESCRIPITION_ANTENNA // Our imagineers have worked tirelessly to get us a UPGRADESIGNAL% boost to the signal and UPGRADEEC% reduction in the EC requirement.
}
@PARTUPGRADE[antennaUpgrade4]:HAS[~antennaUpgrade[off]]:AFTER[KiwiTechTree]
{
	antennaText = #$@KIWI_ANTENNA_SETTINGS/STRENGTH_UPGRADE4_MULTIPLIER$
	@antennaText -= 1
	@antennaText *= 100
	
	ecText = #$@KIWI_ANTENNA_SETTINGS/ECCOST_UPGRADE4_MULTIPLIER$
	@ecText -= 1
	@ecText *= 100
	
	@description ^= #:UPGRADESIGNAL:$antennaText$:
	@description ^= #:UPGRADEEC:$ecText$:
}